<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 科学上网新姿势（docker + ss） · Leyar's Notebook</title><meta name="description" content="科学上网新姿势（docker + ss） - Leyar"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/images/favicon.ico"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://www.leyar.me/atom.xml" title="Leyar's Notebook"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/iLeyar" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">科学上网新姿势（docker + ss）</h1><div class="post-info">2016年4月9日</div><div class="post-content"><p>2016-12-15 更新: Cariana 已失效，可以尝试自建服务器上使用 docker</p>
<p>最近折腾的东西很杂很乱，笔记都没来得及整理。折腾内容包括但不限于： Docker, Ruby on Rails，vim 进阶用法…当然折腾的内容也比较浅显，没有系统的学习显得有点乱，基本是仅能满足需求而已。</p>
<p>这里记录下，使用 <a href="https://getcarina.com/" target="_blank" rel="external">Carina by Rackspace</a> + Docker 实现科学上网的过程。（其实用 Docker 搭建 ssserver 很早就有，只不过一直没研究，这里当作练手了)</p>
<a id="more"></a>
<h2 id="操作步骤"><a href="#操作步骤" class="headerlink" title="操作步骤"></a>操作步骤</h2><blockquote>
<p>操作系统： Arch Linux （Windows 用户参考<a href="http://www.rendoumi.com/wan-quan-mian-fei-de-shadowsocksfu-wu-qi/" target="_blank" rel="external">八戒的博客</a>)<br>涉及内容： Docker 指令，Linux command</p>
</blockquote>
<h3 id="注册帐号"><a href="#注册帐号" class="headerlink" title="注册帐号"></a>注册帐号</h3><p>链接：<a href="https://getcarina.com/" target="_blank" rel="external">https://getcarina.com/</a> ，注册步骤很简单，邮箱验证，手机验证即可。据说手机号可以重复验证多个帐号。</p>
<h3 id="新建-Cluster"><a href="#新建-Cluster" class="headerlink" title="新建 Cluster"></a>新建 Cluster</h3><p>登录界面后的界面，点击 <code>Add Cluster...</code>，进入 <code>Create Cluster</code> 界面，<code>Cluster Name</code> 随便填写一个名字，我这里填写的 <code>ss</code>，点击<code>Create Cluster</code> 按钮，稍等一会，STATUS 变成 <code>active</code> 绿色框框后，点击 <code>Get access</code> 按钮，<code>Download file</code> 下载压缩包到本地。</p>
<p>例如我是下载到 <code>～/Docker</code> 文件夹里，那么<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">cd</span> ～/Docker</div><div class="line">unzip ss.zip</div></pre></td></tr></table></figure></p>
<p>此时会 <code>Docker</code> 目录下生成一个 <code>ss</code> 文件夹。</p>
<h3 id="安装-Docker"><a href="#安装-Docker" class="headerlink" title="安装 Docker"></a>安装 Docker</h3><p>Arch 软件仓库有这个软件包的稳定办，可以直接安装<code>Docker</code><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo pacman -S docker</div></pre></td></tr></table></figure></p>
<h3 id="设置环境变量"><a href="#设置环境变量" class="headerlink" title="设置环境变量"></a>设置环境变量</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">source</span> ～/Docker/ss/docker.env</div></pre></td></tr></table></figure>
<p>此时可以直接操作 Docker 了。<br>使用<code>docker info</code> 命令可以检查是否连接成功。</p>
<h3 id="创建-ss"><a href="#创建-ss" class="headerlink" title="创建 ss"></a>创建 ss</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">docker network create my_network	<span class="comment"># 创建网络，名为“my_network”</span></div><div class="line">docker run <span class="_">-d</span> --name ss --net my_network -p 40004:40004 oddrationale/docker-shadowsocks <span class="_">-s</span> 0.0.0.0 -p 40004 -k <span class="variable">$YOURPASSWORD</span> -m aes-256-cfb</div></pre></td></tr></table></figure>
<p>验证启动情况<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">docker port ss	<span class="comment"># 查询 ss 所使用端口</span></div><div class="line">docker ps	<span class="comment"># 检查进程</span></div></pre></td></tr></table></figure></p>
<p>如果一切正常，那么可以在客户端进行测试了。</p>
<h2 id="待实现"><a href="#待实现" class="headerlink" title="待实现"></a>待实现</h2><p>准备自己做个能包含<code>chacha20</code> 加密协议的<code>Docker 镜像</code>，如果能打包配置文件，似乎也不错诶。</p>
</div></article></div></main><footer><div class="paginator"><a href="/Compile-shadowsocks-libev-in-CentOS7/" class="prev">PREV</a><a href="/skill-tree/" class="next">NEXT</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'ileyar';
var disqus_identifier = 'new-poses-for-scientific-Internet/';
var disqus_title = '科学上网新姿势（docker + ss）';
var disqus_url = 'http://www.leyar.me/new-poses-for-scientific-Internet/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//ileyar.disqus.com/count.js" async></script><div class="copyright"><p>© 2011 - 2017 <a href="http://www.leyar.me">Leyar</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-74627504-2",'auto');ga('send','pageview');</script></body></html>